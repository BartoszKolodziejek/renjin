library(stats)
library(hamcrest)

test.css <- function() {

lh <- structure(c(2.4, 2.4, 2.4, 2.2, 2.1, 1.5, 2.3, 2.3, 2.5, 2, 1.9,  1.7, 2.2, 1.8, 3.2, 3.2, 2.7, 2.2, 2.2, 1.9,
                1.9, 1.8, 2.7, 3,  2.3, 2, 2, 2.9, 2.9, 2.7, 2.7, 2.3, 2.6, 2.4, 1.8, 1.7, 1.5,  1.4, 2.1, 3.3, 3.5,
                3.5, 3.1, 2.6, 2.1, 3.4, 3, 2.9), .Tsp = c(1,  48, 1), class = "ts")


fit <- arima(lh, order = c(3,0,0), method = "CSS")

assertThat(fit$sigma2, closeTo(0.1904692, 1e-6))

assertThat(arima(lh, order = c(1,0,0))$sigma2, closeTo(0.1975, 1e-3))
assertThat(arima(lh, order = c(3,0,0))$sigma2, closeTo(0.1787, 1e-3))
assertThat(arima(lh, order = c(1,0,1))$sigma2, closeTo(0.1923, 1e-3))

}


test.arima2 <- function() {

    WWWusage <- structure(c(
                    88, 84, 85, 85, 84, 85, 83, 85, 88, 89, 91, 99, 104, 112, 126, 138, 146, 151, 150, 148, 147,
                    149, 143, 132, 131, 139, 147, 150, 148, 145, 140, 134, 131, 131, 129, 126, 126, 132, 137, 140, 142, 150,
                    159, 167, 170, 171, 172, 172, 174, 175, 172, 172, 174, 174, 169, 165, 156, 142, 131, 121, 112, 104, 102,
                    99, 99, 95, 88, 84, 84, 87, 89, 88, 85, 86, 89, 91, 91, 94, 101, 110, 121, 135, 145, 149, 156, 165, 171,
                    175, 177, 182, 193, 204, 208, 210, 215, 222, 228, 226, 222, 220), class = "ts", .Tsp = c(1, 100, 1))
    arima(WWWusage, order=c(3,1,0))
}
